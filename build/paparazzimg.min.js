/*!
 * Paparazzimg
 * https://github.com/nyratas/paparazzimg
 *
 * Copyright (c) 2016 Toon Van den Bos
 * Licensed under the MIT license.
 */
"use strict";var paparazzimg=function(t){function i(){window.addEventListener("resize",t.addTrackpoint,!1)}function e(i){return null===i||void 0===i?!1:i.nodeType?new t.tracker(i):(console.error("Paparazzimg: variable is not a valid DOM element."),!1)}function n(t){u[t.id]=t,u[t.id].setActive()}function r(t){return void 0===m[t]?m[t]=[t]:m[t].push(t+m[t].length),m[t][m[t].length-1]}function h(t){return void 0!==u[t]?(u[t].setInactive(),u[t].report()):null}function s(){var t,i={};for(t in u)i[t]=h(t);return i}function a(t){u[t].isActive&&u[t].point()}function o(){for(var t in u)a(t)}var u={},m={};return t.track=function(t){var i=e(t);i&&n(i)},t.release=function(t){return void 0==t?s():h(t)},t.addId=function(t){return t=t.toLowerCase(),r(t)},t.addTrackpoint=function(t){"String"==typeof t&&a(t),o()},i(),t}(paparazzimg||{});paparazzimg.tracker=function(t){this.element=null,this.id=null,this.points=[],this.report=null,this.breaks=null,this.isActive=!1,this.init=function(t){this.element=t,this.setId()},this.setId=function(){this.element.getAttribute("id")?this.id=paparazzimg.addId(this.element.getAttribute("id")):(this.id=paparazzimg.addId(this.element.nodeName),this.element.setAttribute("id",this.id))},this.setActive=function(){this.isActive=!0},this.setInactive=function(){this.isActive=!1},this.report=function(){return this.makeBaseBreaks(),this.makeReport(),this.addMinBreak(),this.reset(),console.log(this.breaks),this.report},this.point=function(){this.points.push(this.getPoint())},this.reset=function(){this.points=[]},this.getPoint=function(){var t={};return t.width=this.element.clientWidth,t.height=this.element.clientHeight,t.ratio=t.width/t.height,t},this.makeReport=function(){this.report={},this.report.count=this.points.length,this.report.extremum=this.getExtremum(),this.report.optimal=this.getOptimal()},this.getExtremum=function(){var t,i,e={},n={};for(t=0;t<this.points.length;t++)for(i in this.points[t])void 0===e[i]?(e[i]={min:this.points[t][i],max:this.points[t][i]},n[i]={min:this.points[t],max:this.points[t]}):this.points[t][i]>e[i].max?(e[i].max=this.points[t][i],n[i].max=this.points[t]):this.points[t][i]<e[i].min&&(e[i].min=this.points[t][i],n[i].min=this.points[t]);return this.addExtremumBreaks(n),e},this.getOptimal=function(){var t={};return t.static=this.getStaticSize(),t.fluidWidth=this.getFluidWidthSize(),t.fluidHeight=this.getFluidHeightSize(),t},this.getStaticSize=function(){return{width:Math.ceil(this.report.extremum.width.max),height:Math.ceil(this.report.extremum.height.max)}},this.getFluidWidthSize=function(){return{width:Math.ceil(this.report.extremum.height.max*this.report.extremum.ratio.max),height:Math.ceil(this.report.extremum.width.max/this.report.extremum.ratio.min)}},this.getFluidHeightSize=function(){return{width:Math.ceil(this.report.extremum.height.min*this.report.extremum.ratio.max),height:Math.ceil(this.report.extremum.width.min/this.report.extremum.ratio.min)}},this.makeBaseBreaks=function(){this.breaks=[],this.addBreak("base",null,null)},this.addBreak=function(t,i,e){var n={};n.type=t,n.width=i>0||0===i?i:null,n.height=e>0||0===e?e:null,this.breaks.push(n)},this.addExtremumBreaks=function(t){var i,e;for(i in t)for(e in t[i])this.addBreak(e+"-"+i,t[i][e].width,t[i][e].height)},this.addMinBreak=function(){this.addBreak("always",this.report.extremum.width.min,this.report.extremum.height.min)},this.init(t)};